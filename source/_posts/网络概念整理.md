
---
title: 网络概念整理
date: 2017-09-17 15:14:50
tags: Socket
---

## OSI层模型、TCP/IP的层模型如下所示：
![](http://api.cocoachina.com/uploads/20150306/1425624664351183.jpg)

## TCP/IP各层对应的协议如下所示：

![](http://api.cocoachina.com/uploads/20150306/1425624804118665.jpg)


通过初步的了解，我知道：

> IP协议：对应于网络层，是网络层的协议，

> TCP协议：对应于传输层，是传输层的协议，主要解决数据如何在网络中传输。

> HTTP协议：对应于应用层，是应用层的协议，主要解决如何包装数据。

> Socket：本身不是协议，而是对TCP/IP协议的封装和应用的调用接口API，通过它我们才能使用TCP/IP协议。



## TCP/IP协议

TCP/IP指传输控制协议/网际协议 (Transmission Control Protocol / Internet Protocol)。

TCP/IP是供已连接因特网的计算机进行通信的通信协议。

TCP/IP定义了电子设备（比如计算机）如何连入因特网，以及数据如何在它们之间传输的标准。

这里有一张图，表明了这些协议的关系。


![](http://api.cocoachina.com/uploads/20150306/1425624881933576.jpg))

# HTTP协议和TCP/IP协议的关系

“我们在传输数据时，可以只使用（传输层）TCP/IP协议，但是那样的话，如果没有应用层，便无法识别数据内容。

如果想要使传输的数据有意义，则必须使用到应用层协议。

应用层协议有很多，比如HTTP、FTP、TELNET等，也可以自己定义应用层协议。

WEB使用HTTP协议作应用层协议，以封装HTTP文本信息，然后使用TCP/IP做传输层协议将它发到网络上。”



## Socket与TCP/IP协议的关系

实际上，Socket跟TCP/IP协议没有必然的联系。

Socket编程接口在设计的时候，就希望也能适应其他的网络协议。所以说，Socket的出现只是使得程序员更方便地使用TCP/IP协议栈而已，是对TCP/IP协议的抽象，从而形成了我们知道的一些最基本的函数接口，比如create、listen、connect、accept、send、read和write等等。


![](http://api.cocoachina.com/uploads/20150306/1425624881933576.jpg))



网络有一段关于socket和TCP/IP协议关系的说法比较容易理解：

“TCP/IP只是一个协议栈，就像操作系统的运行机制一样，必须要具体实现，同时还要提供对外的操作接口。这个就像操作系统会提供标准的编程接口，比如win32编程接口一样，TCP/IP也要提供可供程序员做网络开发所用的接口，这就是Socket编程接口。




## Socket原理

（1）套接字（socket）概念

套接字（socket）是通信的基石，是支持TCP/IP协议的网络通信的基本操作单元。它是网络通信过程中端点的抽象表示，包含进行网络通信必须的五种信息：连接使用的协议，本地主机的IP地址，本地进程的协议端口，远地主机的IP地址，远地进程的协议端口。

套接字： { IP地址 : 端口号 }

应用层通过传输层进行数据通信时，TCP会遇到同时为多个应用程序进程提供并发服务的问题。多个TCP连接或多个应用程序进程可能需要通过同一个TCP协议端口传输数据。为了区别不同的应用程序进程和连接，许多计算机操作系统为应用程序与TCP／IP协议交互提供了套接字(Socket)接口。应用层可以和传输层通过Socket接口，区分来自不同应用程序进程或网络连接的通信，实现数据传输的并发服务。



（2）建立socket连接

建立Socket连接至少需要一对套接字，其中一个运行于客户端，称为ClientSocket ，另一个运行于服务器端，称为ServerSocket 。

套接字之间的连接过程分为三个步骤：服务器监听，客户端请求，连接确认。

（a）服务器监听：服务器端套接字并不定位具体的客户端套接字，而是处于等待连接的状态，实时监控网络状态，等待客户端的连接请求。

（b）客户端请求：指客户端的套接字提出连接请求，要连接的目标是服务器端的套接字。为此，客户端的套接字必须首先描述它要连接的服务器的套接字，指出服务器端套接字的地址和端口号，然后就向服务器端套接字提出连接请求。

（c）连接确认：当服务器端套接字监听到或者说接收到客户端套接字的连接请求时，就响应客户端套接字的请求，建立一个新的线程，把服务器端套接字的描述发给客户端，一旦客户端确认了此描述，双方就正式建立连接。而服务器端套接字继续处于监听状态，继续接收其他客户端套接字的连接请求。


![](http://api.cocoachina.com/uploads/20150306/1425625191662279.jpg)
